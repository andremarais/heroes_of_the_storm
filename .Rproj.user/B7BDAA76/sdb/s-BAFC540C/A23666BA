{
    "collab_server" : "",
    "contents" : "library(plyr)\nlibrary(ggplot2)\nlibrary(magrittr)\nlibrary(scales)\nlibrary(jsonlite)\n\ngames <- read.csv('ReplayCharacters 2015-12-30 - 2016-01-29.csv')\ngames <- games[games$ReplayID %in% unique(games$ReplayID)[sample(length(unique(games$ReplayID)), 10000)], ]\ngc()\ngames_info <- read.csv('Replays 2015-12-30 - 2016-01-29.csv')\ngames_info$Timestamp..UTC. <- as.Date(substring(games_info$Timestamp..UTC., 1, 10), '%m/%d/%Y')\n\nhero.info <- read.csv('hero_info.csv')\ngames <- merge(games, hero.info, by =\"HeroID\")\ngames <- merge(games, games_info[, c('ReplayID', 'Timestamp..UTC.')], by = 'ReplayID')\ngames <- games[!is.na(games$MMR.Before), ]\ngames <- games[order(games$ReplayID, games$Is.Winner),]\n\n\n# kak plot\nrole_agg <- \n  count(df = games, vars =  c(\"ReplayID\", \"Is.Winner\", \"Role\")) \naggregate(data = role_agg,freq ~ Role + Is.Winner, mean)  %>%\n  ggplot() + geom_bar(aes(y = freq, x = Role), stat = 'identity') + facet_grid(Is.Winner ~.)\n\n# MMR rating of 1700 is a problem, it might be the starting rating\n# imputing it makes sense to smooth the ratings \n\nsource('lm.R')\n\n\nheroes$MMR.Before.adj <- heroes$MMR.Before\nheroes$MMR.Before.adj[heroes$MMR.Before == 1700] <- predict(MMR_model, heroes[heroes$MMR.Before == 1700, ])\n\nggplot(heroes) +\n  geom_density(aes(x = MMR.Before), fill = 'dodgerblue', alpha = .65) +\n  geom_density(aes(x = MMR.Before.adj), fill = 'indianred', alpha = .65) +\n  theme_minimal()\n\nggplot() + \n  geom_density(data = heroes[heroes$Is.Winner == 'True', ], \n               aes(x = MMR.Before.adj), fill = 'dodgerblue', alpha = .65) +\n  geom_density(data = heroes[heroes$Is.Winner == 'False', ], \n               aes(x = MMR.Before.adj), fill = 'indianred', alpha = .65) +\n  theme_minimal()\n\nhero.win.rate <- aggregate(data = heroes, Is.Winner == 'True' ~ HeroID, mean) \n  \ncolnames(hero.win.rate) <- c(\"Hero\", \"WR\")\nggplot(hero.win.rate) + \n  geom_bar(aes(x = reorder(Hero, -WR), y = WR), stat = 'identity', fill = 'lightsteelblue1') +\n  theme_minimal() %+replace% \n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_text()) + \n  annotate(geom = 'text', \n           x = reorder(hero.win.rate$Hero, -hero.win.rate$WR), \n           y = 0.1, \n           label = reorder(hero.win.rate$Hero, -hero.win.rate$WR), \n           angle = 90,\n           col = 'lightsteelblue4') +\n  annotate(geom = 'text', \n           x = levels(reorder(hero.win.rate$Hero, -hero.win.rate$WR))[1], \n           y = 0.51, \n           label = '50%',\n           col = 'lightsteelblue4') +\n  geom_hline(yintercept = .5, col = 'lightsteelblue3')+\n  xlab('Heroes') +\n  ylab('Win rate')\n\nhero_mmr_winrate <- \n  aggregate(data = heroes, MMR.Before ~ Hero + Is.Winner, mean) \n\nggplot(hero_mmr_winrate) + \n  geom_bar(aes(x = reorder(Hero, -MMR.Before), y = MMR.Before, fill = Is.Winner), stat = 'identity', position = 'dodge')+\n  theme_minimal() %+replace% \n  theme(axis.text.x = element_blank()) +\n  scale_fill_manual(values = c('lightsteelblue1', 'lightsteelblue2')) +\n  annotate(geom = 'text', \n           x = reorder(hero_mmr_winrate$Hero, -hero_mmr_winrate$MMR.Before), \n           y = 200, \n           label = reorder(hero_mmr_winrate$Hero, -hero_mmr_winrate$MMR.Before), \n           angle = 90,\n           col = 'lightsteelblue4') +\n  xlab('Heroes') +\n  ylab('MMR Rating')\n\n\n\nGroup_diff <- read.csv('Group_diff.csv')\n\nggplot(Group_diff) + \n  geom_bar(aes(x = Group, y = Group.difference, fill = Group.difference, col = Group.difference), stat = 'identity', position = 'dodge') +\n  facet_grid(.~MapID) +\n  scale_fill_continuous(low = 'royalblue1', high = 'indianred1') +\n  scale_color_continuous(low = 'royalblue3', high = 'indianred3') +\n  theme_light() %+replace% \n  theme(axis.text.x = element_text(angle = 90), legend.position = 'none', axis.text.y = element_blank()) +\n  ylab('Team composition') +\n  xlab('Role') + \n  ggtitle('Team composition over maps') \n\n\n\nRole_winrate <- read.csv('Role_winrate.csv')\nggplot(Role_winrate) +\n  geom_bar(aes(x = reorder(SubGroup, as.numeric(Group)), y = Is.Winner, fill = Group), stat = 'identity', position = 'dodge')\n",
    "created" : 1476168188737.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3615781217",
    "id" : "A23666BA",
    "lastKnownWriteTime" : 1477933871,
    "last_content_update" : 1477933871201,
    "path" : "C:/Worksies/hots/eh.R",
    "project_path" : "eh.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}