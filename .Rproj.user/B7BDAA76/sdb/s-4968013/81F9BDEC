{
    "collab_server" : "",
    "contents" : "library(ggplot2)\nlibrary(scales)\n\nhero_winrate <- read.csv('data/MMR_hero_overtime.csv')\nhero_winrate$Game.Date <- as.Date(as.character(hero_winrate$Game.Date), '%Y-%m-%d')\nheroes <- read.csv('data/hero_info.csv')\nhero_winrate <- merge(hero_winrate, heroes[ ,c('HeroID', 'PrimaryName')], by='HeroID', all.x=T)\nWinningMMRperHero <- read.csv('data/WinningMMRperHero.csv')\nauto <-read.csv('data/Auto.csv')\n\npop <- read.csv('data/Popularity.csv')\nlevels(pop$Difficulty) <- c('Easy', 'Medium', 'Hard', 'Very Hard')\npop <- aggregate(data = pop, X0~ PrimaryName + Group + Difficulty, mean)\n\n\nGroup_diff <- read.csv('data/Group_diff.csv')\n\n\nplot_colors_fill <- c('dodgerblue2',\n                      'indianred2',\n                      'goldenrod3',\n                      'palegreen3'\n)\n\nplot_colors_outline <- c('dodgerblue2',\n                         'indianred2',\n                         'goldenrod3',\n                         'palegreen3'\n)\n\nshinyServer(\n  function(input, output) {\n    output$hotsplot <- renderPlot({\n      \n      # Plot for Hero MMR rating over time\n      if (input$HotsSelectInput == 'Hero MMR rating' & input$HeroMMRRadio == 'Over time') {\n        \n        ggplot(hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, ]) + \n          geom_bar(aes(x = reorder(PrimaryName, -Adj.MMR.Before), y = Adj.MMR.Before, fill = Group, col = Group), stat = 'identity', alpha = .55)+\n          theme_minimal() %+replace% \n          theme(axis.text.x = element_blank()) +\n          # scale_fill_manual(values = c('lightsteelblue1', 'lightsteelblue2')) +\n          annotate(geom = 'text', \n                   x = reorder(hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, 'PrimaryName'], -hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, 'Adj.MMR.Before']), \n                   y = 500, \n                   label = reorder(hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, 'PrimaryName'], -hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, 'Adj.MMR.Before']), \n                   angle = 90,\n                   col = 'black', size = 5) +\n          xlab('Heroes') +\n          ylab('MMR Rating') + \n          scale_fill_manual(values = plot_colors_fill) +\n          scale_color_manual(values = plot_colors_outline)\n        \n      } \n      \n      # Plot for Hero MMR rating over win rate\n      else if (input$HotsSelectInput == 'Hero MMR rating' & input$HeroMMRRadio == 'Win vs loose' ){\n        ggplot(WinningMMRperHero) + \n          geom_bar(aes(x = reorder(PrimaryName, - Adj.MMR.Before), \n                       y = Adj.MMR.Before, fill = Is.Winner, col = Is.Winner), \n                   stat = 'identity', position = 'dodge', alpha = .55) +\n          annotate(geom = 'text', \n                   x = reorder(WinningMMRperHero$PrimaryName, - WinningMMRperHero$Adj.MMR.Before), \n                   y = 500, \n                   label = reorder(WinningMMRperHero$PrimaryName, - WinningMMRperHero$Adj.MMR.Before), \n                   angle = 90,\n                   col = 'black', size = 5) +\n          theme_minimal() %+replace%\n          theme(axis.text.x = element_blank(),\n                legend.position = 'none') + \n          scale_fill_manual(values = c('indianred1','royalblue1')) +\n          scale_color_manual(values = c('indianred1','royalblue1')) +\n          ggtitle('Average MMR rating of heores played') +\n          xlab('Blue: Won game | Red: Lost game') +\n          ylab('MMR Before game')\n        \n        \n      }\n      \n      # Plot for auto select over win rate\n      else if (input$HotsSelectInput == 'Auto selected heroes'){\n        ggplot(auto) + \n          geom_bar(aes(x = reorder(PrimaryName, -Is.Winner), \n                       y = Is.Winner, \n                       fill = Is.Auto.Select,\n                       col = Is.Auto.Select), \n                   stat = 'identity', position = 'dodge',\n                   alpha = .55)+\n          theme_minimal() %+replace%\n          theme(axis.text.x = element_blank(),\n                axis.title.y = element_blank())+\n          scale_fill_manual(values = plot_colors_fill) + \n          scale_color_manual(values = plot_colors_outline) +\n          scale_y_continuous(labels = percent)+\n          xlab('Hero') +\n          annotate(geom = 'text', \n                   x = reorder(auto$PrimaryName, -auto$Is.Winner), \n                   y = max(auto$Is.Winner)*.01, \n                   hjust = 0,\n                   label = reorder(auto$PrimaryName, -auto$Is.Winner), \n                   angle = 90,\n                   col = 'black',\n                   size = 5) +\n          ggtitle('Win rate of auto selected heroes') +\n          geom_hline(yintercept = .5, col = 'dodgerblue4') +\n          annotate(geom = 'text', \n                   x = 0, \n                   y = .5, \n                   hjust = -1,\n                   vjust = -1,\n                   label = '50%',\n                   size = 5, col = 'dodgerblue4') \n        \n        \n      }\n      \n      # Plot for Hero popularity\n      else if (input$HotsSelectInput == 'Hero popularity'){\n        ggplot(pop) + \n          geom_bar(aes_string(x = reorder(pop$PrimaryName, -pop$X0), \n                              y = pop$X0, \n                              fill = input$PopRadio,\n                              col = input$PopRadio), \n                   stat = 'identity',\n                   alpha = .55) +\n          theme_minimal() %+replace%\n          theme(axis.text.x = element_blank(),\n                axis.title.y = element_blank())+\n          scale_fill_manual(values = plot_colors_fill) + \n          scale_color_manual(values = plot_colors_outline) +\n          xlab('Hero') +\n          annotate(geom = 'text', \n                   x = reorder(pop$PrimaryName, -pop$X0), \n                   y = max(pop$X0)*.01, \n                   hjust = 0,\n                   label = reorder(pop$PrimaryName, -pop$X0), \n                   angle = 90,\n                   col = 'black') +\n          ggtitle('Hero popularity')\n        \n        \n        \n      }\n      \n      \n      else if (input$HotsSelectInput == 'Win rate per role per map') {\n        \n        ggplot(Group_diff) + \n          geom_bar(aes(x = Group, y = Group.difference, fill = Group.difference, col = Group.difference), stat = 'identity', position = 'dodge') +\n          facet_grid(.~Map.Name) +\n          scale_fill_continuous(low = 'indianred1', high = 'royalblue1') +\n          scale_color_continuous(low = 'indianred3', high = 'royalblue3') +\n          theme_light() %+replace% \n          theme(axis.text.x = element_text(angle = 90), legend.position = 'none', axis.text.y = element_blank()) +\n          ylab('Team composition') +\n          xlab('Role') + \n          ggtitle('Team composition over maps') \n        \n        \n      }\n      \n      \n      \n    })\n    \n    \n    \n    output$imagespace <- renderImage({\n      fm <- c()\n      if (input$HotsSelectInput == \"Game duration\")  {\n        fm <- normalizePath(file.path('png_files/MMR_herolvl.png'))\n        \n      }\n      list(src = fm)\n    }\n    \n    , deleteFile = FALSE)\n    \n  }\n)\n\n\n\n",
    "created" : 1478178172176.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4137134197",
    "id" : "81F9BDEC",
    "lastKnownWriteTime" : 1478178043,
    "last_content_update" : 1478178043,
    "path" : "C:/Worksies/hots/server_backup.R",
    "project_path" : "server_backup.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}