{
    "collab_server" : "",
    "contents" : "library(ggplot2)\n\nhero_winrate <- read.csv('data/MMR_hero_overtime.csv')\nhero_winrate$Game.Date <- as.Date(as.character(hero_winrate$Game.Date), '%Y-%m-%d')\nheroes <- read.csv('data/hero_info.csv')\nhero_winrate <- merge(hero_winrate, heroes[ ,c('HeroID', 'PrimaryName')], by='HeroID', all.x=T)\nWinningMMRperHero <- read.csv('data/WinningMMRperHero.csv')\n\n\npop <- read.csv('data/Popularity.csv')\nlevels(pop$Difficulty) <- c('Easy', 'Medium', 'Hard', 'Very Hard')\npop <- aggregate(data = pop, X0~ PrimaryName + Group + Difficulty, mean)\n\n\nGroup_diff <- read.csv('data/Group_diff.csv')\n\n\nplot_colors_fill <- c('dodgerblue2',\n                      'indianred2',\n                 'goldenrod3',\n                 'palegreen3'\n                 )\n\nplot_colors_outline <- c('dodgerblue4',\n                         'indianred4',\n                      'goldenrod4',\n                      'palegreen4'\n                      )\n\nshinyServer(\n  function(input, output) {\n    output$hotsplot <- renderPlot({\n\n      if (input$HotsSelectInput == 'Hero MMR rating' & input$MMROverTime) {\n      \n      ggplot(hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, ]) + \n        geom_bar(aes(x = reorder(PrimaryName, -Adj.MMR.Before), y = Adj.MMR.Before, fill = Group, col = Group), stat = 'identity', alpha = .55)+\n        theme_minimal() %+replace% \n        theme(axis.text.x = element_blank()) +\n        # scale_fill_manual(values = c('lightsteelblue1', 'lightsteelblue2')) +\n        annotate(geom = 'text', \n                 x = reorder(hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, 'PrimaryName'], -hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, 'Adj.MMR.Before']), \n                 y = 500, \n                 label = reorder(hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, 'PrimaryName'], -hero_winrate[hero_winrate$Game.Date == input$HeroMMRSlider, 'Adj.MMR.Before']), \n                 angle = 90,\n                 col = 'black', size = 5) +\n        xlab('Heroes') +\n        ylab('MMR Rating') + \n        scale_fill_manual(values = plot_colors_fill) +\n        scale_color_manual(values = plot_colors_outline)\n        \n      } \n      \n      else if (input$HotsSelectInput == 'Hero MMR rating' & !input$MMROverTime){\n        ggplot(WinningMMRperHero) + \n          geom_bar(aes(x = reorder(PrimaryName, - Adj.MMR.Before), \n                       y = Adj.MMR.Before, fill = Is.Winner, col = Is.Winner), \n                   stat = 'identity', position = 'dodge', alpha = .55) +\n          annotate(geom = 'text', \n                   x = reorder(WinningMMRperHero$PrimaryName, - WinningMMRperHero$Adj.MMR.Before), \n                   y = 500, \n                   label = reorder(WinningMMRperHero$PrimaryName, - WinningMMRperHero$Adj.MMR.Before), \n                   angle = 90,\n                   col = 'black', size = 5) +\n          theme_minimal() %+replace%\n          theme(axis.text.x = element_blank(),\n                legend.position = 'none') + \n          scale_fill_manual(values = c('indianred1','royalblue1')) +\n          scale_color_manual(values = c('indianred1','royalblue1')) +\n          ggtitle('Average MMR rating of heores played') +\n          xlab('Blue: Won game | Red: Lost game') +\n          ylab('MMR Before game')\n        \n        \n      }\n      \n      else if (input$HotsSelectInput == 'Hero popularity'){\n        ggplot(pop) + \n          geom_bar(aes_string(x = reorder(pop$PrimaryName, -pop$X0), \n                       y = pop$X0, \n                       fill = input$PopRatio,\n                       col = input$PopRatio), \n                   stat = 'identity',\n                   alpha = .55) +\n          theme_minimal() %+replace%\n          theme(axis.text.x = element_blank(),\n                axis.title.y = element_blank())+\n          scale_fill_manual(values = plot_colors_fill) + \n          scale_color_manual(values = plot_colors_outline) +\n          xlab('Hero') +\n          annotate(geom = 'text', \n                   x = reorder(pop$PrimaryName, -pop$X0), \n                   y = max(pop$X0)*.01, \n                   hjust = 0,\n                   label = reorder(pop$PrimaryName, -pop$X0), \n                   angle = 90,\n                   col = 'black') +\n          ggtitle('Hero popularity')\n        \n        \n        \n      }\n      \n      \n      else if (input$HotsSelectInput == 'Win rate per role per map') {\n        \n        ggplot(Group_diff) + \n          geom_bar(aes(x = Group, y = Group.difference, fill = Group.difference, col = Group.difference), stat = 'identity', position = 'dodge') +\n          facet_grid(.~MapID) +\n          scale_fill_continuous(low = 'indianred1', high = 'royalblue1') +\n          scale_color_continuous(low = 'indianred3', high = 'royalblue3') +\n          theme_light() %+replace% \n          theme(axis.text.x = element_text(angle = 90), legend.position = 'none', axis.text.y = element_blank()) +\n          ylab('Team composition') +\n          xlab('Role') + \n          ggtitle('Team composition over maps') \n        \n        \n      }\n      \n\n      \n    })\n    \n  }\n)\n\n\n                          \n                          ",
    "created" : 1477551731539.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3173499717",
    "id" : "443766C1",
    "lastKnownWriteTime" : 1478002573,
    "last_content_update" : 1478002573277,
    "path" : "C:/Worksies/hots/shiny/server.R",
    "project_path" : "shiny/server.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}